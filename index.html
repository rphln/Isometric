<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>N9</title>
    <meta content="" name="description" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />

    <meta content="" property="og:title" />
    <meta content="" property="og:type" />
    <meta content="" property="og:url" />
    <meta content="" property="og:image" />

    <link href="site.webmanifest" rel="manifest" />
    <link href="icon.png" rel="apple-touch-icon" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      integrity="sha256-YvdLHPgkqJ8DVUxjjnGVlMMJtNimJ6dYkowFFvp4kKs="
      crossorigin="anonymous"
    />
    <link
      rel="modulepreload"
      href="https://cdn.jsdelivr.net/npm/htm@3.1.0/preact/standalone.module.js"
      integrity="sha256-cihOjpB5yHgXFF3xEQ906KKqBAsvw4SSLhjfy0b8H9c="
      crossorigin="anonymous"
    />
    <link
      rel="modulepreload"
      href="https://cdn.jsdelivr.net/npm/lodash-es@4.17.21/lodash.js"
      integrity="sha256-3Z1lMvgvlTdGQAbkYjupO0D1k+/SNE+X5etUNDAvEdc="
      crossorigin="anonymous"
    />

    <meta content="#fafafa" name="theme-color" />
    <link href="app.css" rel="stylesheet" />
  </head>

  <body>
    <main class="container py-5" id="app"></main>
    <script type="module">
      import {
        html,
        render,
        Component,
      } from "https://cdn.jsdelivr.net/npm/htm@3.1.0/preact/standalone.module.js";
      import {
        range,
        isEqual,
      } from "https://cdn.jsdelivr.net/npm/lodash-es@4.17.21/lodash.js";

      function hashCode(object) {
        let k = object.toString();
        let hash = 0;
        for (let i = 0; i < k.length; i++) {
          const code = k.charCodeAt(i);
          hash = (hash << 5) - hash + code;
          hash = hash & hash; // Convert to 32bit integer
        }

        return hash;
      }

      class App extends Component {
        state = {
          cube: true,
          borders: true,
          isometric: true,
          offset: true,
        };

        render({}, { selected, offset, isometric, borders, cube }) {
          const grid = HexGrid({
            height: 7,
            width: 7,
            selected,
            offset,
            borders,
            isometric,
            cube,
            size: 100,
            tileClicked: (selected) => this.setState({ selected }),
          });

          const rest = html`
            <div class="form-check form-switch form-check-inline mx-2">
              <label class="form-check-label">
                <input
                  class="form-check-input"
                  type="checkbox"
                  checked=${!!isometric}
                  onChange=${(e) =>
                    this.setState({ isometric: e.target.checked })}
                />
                Isometric?
              </label>
            </div>
            <div class="form-check form-switch form-check-inline mx-2">
              <label class="form-check-label">
                <input
                  class="form-check-input"
                  type="checkbox"
                  checked=${!!offset}
                  onChange=${(e) => this.setState({ offset: e.target.checked })}
                />
                Offset?
              </label>
            </div>
            <div class="form-check form-switch form-check-inline mx-2">
              <label class="form-check-label">
                <input
                  class="form-check-input"
                  type="checkbox"
                  checked=${!!borders}
                  onChange=${(e) =>
                    this.setState({ borders: e.target.checked })}
                />
                Borders?
              </label>
            </div>
            <div class="form-check form-switch form-check-inline mx-2">
              <label class="form-check-label">
                <input
                  class="form-check-input"
                  type="checkbox"
                  checked=${!!cube}
                  onChange=${(e) => this.setState({ cube: e.target.checked })}
                />
                Cube?
              </label>
            </div>
          `;

          return html`<div class="py-3">${rest}</div>
            <div class="container">${grid}</div>`;
        }
      }

      function HexGrid({
        width,
        height,
        selected,
        tileClicked,
        cube,
        borders,
        offset,
        isometric,
      }) {
        const elevation = {
          "5-1": 1,
          "4-1": 2,
          "3-2": 3,
          "2-3": 5,
          "3-3": 4,
        };

        return html`<div
          class="hex-grid ${isometric && "isometric"} ${offset &&
          "offset-even-r"} ${borders && "borders"}"
        >
          ${range(height).map(
            (y) =>
              html`<div class="grid-row">
                ${range(width).map(
                  (x) => html`<div
                    data-elevation="${elevation[`${y}-${x}`]}"
                    data-x=${x}
                    data-y=${y}
                    class="grid-col ${cube && "ground"}"
                  >
                    <label>${y}:${x}</label>
                  </div>`
                )}
              </div>`
          )}
        </div>`;
      }

      render(html` <${App} size=${100} />`, document.querySelector("#app"));
    </script>
  </body>
</html>
